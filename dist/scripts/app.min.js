/**
 * audiowalk
 * @version v0.1.0 - 2014-06-12
 * @link https://github.com/lennart/audiowalk
 * @author Lennart Melzer ()
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";var app=angular.module("lennart.Audiowalk",["ngAnimate","ngRoute","slick","ui.bootstrap","fitVids"]);app.constant("version","v0.1.0").config(["$locationProvider","$routeProvider",function(e,o){e.html5Mode(!1),o.when("/",{templateUrl:"views/home.html"}).when("/features",{templateUrl:"views/features.html"}).when("/contact",{templateUrl:"views/contact.html"}).otherwise({redirectTo:"/"})}]),app.controller("MainCtrl",["$scope","$location","version","$log","VideoPlayer","$window",function(e,o,i,a,n){e.$path=o.path.bind(o),e.version=i,n.get().then(function(e){a.info("got player",e)}).catch(function(e){a.error("error in video player",e)})}]),app.controller("PlacesCtrl",["$scope","StoryBoard","$log","$window",function(e,o,i){e.myInterval=5e3;var a=e.slides=o();e.addSlide=function(){600+a.length};for(var n=0;4>n;n++)e.addSlide();i.info("slides",a)}]),app.controller("VideoCtrl",["$element","$log","$document",function(){}]),app.service("VideoPlayer",["$window","$log","$q",function(e,o,i){this.get=function(){var a=i.defer();return e.YT?a.resolve(YT.Player):e.onYouTubeIframeAPIReady=function(){o.info("YouTube Player API Ready",YT.Player),a.resolve(YT.Player)},a.promise}}]),app.value("StoryBoard",function(){return[{title:"BRAVE<br>NEW<br>WORK"},{caption:"Kaffee kochen",video:"PFVcfyqm9_Y",videoStill:"kaffee-kochen.jpg"},{caption:"St. Oberholz",audio:"01-stoberholz.m4a"}]}),app.controller("AudioCtrl",["$log","$scope","$element",function(e,o,i){o.playing=0;{var a=i.find("#sc-widget")[0];a.id}o.widget=SC.Widget(a);var n=i.find("button"),t=i.find("audio")[0];o.$watch("playing",function(e){e?(n.addClass("playing"),t.play()):(n.removeClass("playing"),o.widget.pause(),t.pause())})}]),app.directive("bnwVideoPlayer",["$log","VideoPlayer","$timeout",function(e,o,i){return{restrict:"E",link:function(a,n){var t="video-player-"+a.index;n.find(".video-player").attr("id",t);var r=n.find(".btn-video-play"),d=n.find(".spinner"),l=n.find(".glyphicon-facetime-video");a.videoLoaded=!1,a.playing=!1;var s=n.find(".video-wrapper"),c=n.find("video")[0];r.click(function(){a.loading=!0,a.playing=!0,d.removeClass("hide"),l.addClass("hide"),i(function(){o.get().then(a.loadVideo).catch(function(o){e.error("error on player get",o)})},3e3)}),a.loadVideo=function(o){e.info("player on click",o,t),a.videoLoaded,a.onVideoReady()},c.addEventListener("playing",function(){s.removeClass("hide"),r.addClass("hide")}),c.addEventListener("pause",function(){r.removeClass("hide"),s.addClass("hide"),l.removeClass("hide")}),a.onVideoReady=function(){a.videoLoaded=!0,c.play(),a.playing=!0,a.loading=!1,d.addClass("hide")},a.onStateChange=function(o){switch(e.info("state change",o),o.data){case YT.PlayerState.PLAYING:case YT.PlayerState.BUFFERING:s.removeClass("hide"),r.addClass("hide");break;case YT.PlayerState.ENDED:case YT.PlayerState.PAUSED:r.removeClass("hide"),s.addClass("hide")}},a.stopVideo=function(){player.pause(),a.playing=!1}}}}]);