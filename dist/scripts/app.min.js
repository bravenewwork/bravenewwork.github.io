/**
 * audiowalk
 * @version v0.1.0 - 2014-06-12
 * @link https://github.com/lennart/audiowalk
 * @author Lennart Melzer ()
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";var app=angular.module("lennart.Audiowalk",["ngAnimate","ngRoute","slick","duScroll","FBAngular","google-maps","ui.bootstrap","fitVids"]);app.constant("version","v0.1.0").config(["$locationProvider","$routeProvider",function(e,n){e.html5Mode(!1),n.when("/",{templateUrl:"views/home.html"}).when("/features",{templateUrl:"views/features.html"}).when("/contact",{templateUrl:"views/contact.html"}).otherwise({redirectTo:"/"})}]),app.controller("MainCtrl",["$scope","$location","version","$log","VideoPlayer","$window","Fullscreen",function(e,n,a,o,i,t,l){e.$path=n.path.bind(n),e.version=a,i.get().then(function(e){o.info("got player",e)}).catch(function(e){o.error("error in video player",e)}),l.all(),o.info("Standalone",t.navigator.standalone)}]),app.controller("PlacesCtrl",["$scope","StoryBoard","$log","$window","$element",function(e,n,a){e.myInterval=5e3;var o=e.slides=n();e.addSlide=function(){600+o.length};for(var i=0;4>i;i++)e.addSlide();a.info("slides",o)}]),app.controller("PlaceCtrl",["$log","$element","$document",function(e,n,a){var o=n;e.info("media content links",o[0],n),o.click(function(o){e.info("registering click handler for scrolling",this);var i="#"+this.href.split("#").pop(),t=n.parents(),l=t.find(i);a.scrollToElement(l,10,500),o.preventDefault()})}]),app.controller("VideoCtrl",["$element","$log","$document",function(){}]),app.controller("MapCtrl",["$log","$element","$scope","$location",function(e,n,a,o){a.map={center:{latitude:52.529781,longitude:13.401393},zoom:17,showKml:!0},a.kmlLayerOptions={url:o.absUrl()+"/data/01-ausland.kml"}}]),app.service("VideoPlayer",["$window","$log","$q",function(e,n,a){this.get=function(){var o=a.defer();return e.YT?o.resolve(YT.Player):e.onYouTubeIframeAPIReady=function(){n.info("YouTube Player API Ready",YT.Player),o.resolve(YT.Player)},o.promise}}]),app.value("StoryBoard",function(){return[{title:"BRAVE<br>NEW<br>WORK"},{caption:"Kaffee kochen",quote:"Eine Gratwanderung zwischen Elitarismus und Alternativit√§t",scrollDown:!0,video:"PFVcfyqm9_Y",videoStill:"kaffee-kochen.jpg"},{caption:"St. Oberholz",audio:"01-stoberholz.m4a"},{caption:"Weg zum Haus aus einem anderen Land",maps:"https://www.google.com/maps/embed?pb=!1m29!1m12!1m3!1d1213.5841912603892!2d13.40105350178898!3d52.530387583271406!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m14!1i0!3e2!4m5!1s0x47a851e51ffe4c8f%3A0x81d84dd51899d817!2sBrunnenstra%C3%9Fe+11%2C+10119+Berlin%2C+Germany!3m2!1d52.5313641!2d13.400299799999999!4m5!1s0x47a851e4644a4b75%3A0xf49417256487121c!2sGastst%C3%A4tte+St.+Oberholz%2C+Rosenthaler+Stra%C3%9Fe+72a%2C+10119+Berlin%2C+Germany!3m2!1d52.529512!2d13.401764!5e0!3m2!1sen!2s!4v1402598598218"},{quote:"No one has ever become poor by giving. - Anne Frank",image:"/images/tip-jar.jpg"}]}),app.controller("AudioCtrl",["$log","$scope","$element",function(e,n,a){n.playing=0;{var o=a.find("#sc-widget")[0];o.id}n.widget=SC.Widget(o);var i=a.find("button"),t=a.find("audio")[0];n.$watch("playing",function(e){e?(i.addClass("playing"),t.play()):(i.removeClass("playing"),n.widget.pause(),t.pause())})}]),app.directive("bnwVideoPlayer",["$log","VideoPlayer","$timeout",function(e,n,a){return{restrict:"E",link:function(o,i){var t="video-player-"+o.index;i.find(".video-player").attr("id",t);var l=i.find(".btn-video-play"),r=i.find(".spinner"),d=i.find(".glyphicon-facetime-video");o.videoLoaded=!1,o.playing=!1;var s=i.find(".video-wrapper"),c=i.find("video")[0];l.click(function(){o.loading=!0,o.playing=!0,r.removeClass("hide"),d.addClass("hide"),a(function(){n.get().then(o.loadVideo).catch(function(n){e.error("error on player get",n)})},3e3)}),o.loadVideo=function(n){e.info("player on click",n,t),o.videoLoaded,o.onVideoReady()},c.addEventListener("playing",function(){s.removeClass("hide"),l.addClass("hide")}),c.addEventListener("pause",function(){l.removeClass("hide"),s.addClass("hide"),d.removeClass("hide")}),o.onVideoReady=function(){o.videoLoaded=!0,c.play(),o.playing=!0,o.loading=!1,r.addClass("hide")},o.onStateChange=function(n){switch(e.info("state change",n),n.data){case YT.PlayerState.PLAYING:case YT.PlayerState.BUFFERING:s.removeClass("hide"),l.addClass("hide");break;case YT.PlayerState.ENDED:case YT.PlayerState.PAUSED:l.removeClass("hide"),s.addClass("hide")}},o.stopVideo=function(){player.pause(),o.playing=!1}}}}]);